#!/usr/bin/env bash

SCRIPT_DIR=$(cd "$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")" && pwd)

# Set environment variable for actual program name of Xarpite
if [ -z "$XARPITE_PROGRAM_NAME" ]
then
  XARPITE_PROGRAM_NAME=${0##*/}
  export XARPITE_PROGRAM_NAME
fi

# Parse launcher options (pass them through to xarpite)
LAUNCHER_OPTIONS=()
while (($# > 0))
do
  if [ "$1" = "--native" ] || [ "$1" = "--jvm" ] || [ "$1" = "--node" ]
  then
    LAUNCHER_OPTIONS+=("$1")
    shift
    continue
  fi
  break
done

# Call xarpite with launcher options, --short, and remaining arguments
exec "$SCRIPT_DIR/xarpite" "${LAUNCHER_OPTIONS[@]}" --short "$@"
