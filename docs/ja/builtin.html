<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>組み込みオブジェクトのクラス定数 - Xarpite</title>
  <meta name="description" content="An interpreted language for one-liners">
  <link rel="stylesheet" href="/xarpite/assets/css/style.css">
  <link rel="icon" type="image/svg+xml" href="/xarpite/assets/images/xarpite-icon.svg">
</head>
<body>
  <div class="page-wrapper">
    <header class="site-header">
      <div class="container">
        <div class="header-content">
          <a href="/xarpite/" class="logo-link">
            <img src="/xarpite/assets/images/xarpite-icon.svg" alt="Xarpite Icon" class="logo-icon">
            <span class="logo-text">Xarpite</span>
          </a>
          <nav class="main-nav">
            <a href="/xarpite/docs/ja/" class="nav-link">ドキュメント</a>
            <a href="https://github.com/MirrgieRiana/xarpite" class="nav-link" target="_blank">GitHub</a>
            <a href="https://mirrgieriana.github.io/xarpite/playground/" class="nav-link playground-link" target="_blank">Playground</a>
          </nav>
        </div>
      </div>
    </header>

    <main class="main-content">
      <div class="container">
        <div class="content-wrapper">
          <aside class="sidebar">
            <nav class="doc-nav">
              <h3 class="nav-title">ドキュメント</h3>
              <ul class="nav-list">
                <li><a href="/xarpite/docs/ja/">トップ</a></li>
                <li><a href="/xarpite/docs/ja/syntax.html">文法</a></li>
                <li><a href="/xarpite/docs/ja/statement.html">文・式</a></li>
                <li><a href="/xarpite/docs/ja/whitespace.html">空白・コメント</a></li>
                <li><a href="/xarpite/docs/ja/variable.html">変数</a></li>
                <li><a href="/xarpite/docs/ja/number.html">数値</a></li>
                <li><a href="/xarpite/docs/ja/string.html">文字列</a></li>
                <li><a href="/xarpite/docs/ja/regex.html">正規表現</a></li>
                <li><a href="/xarpite/docs/ja/blob.html">BLOB</a></li>
                <li><a href="/xarpite/docs/ja/comparison.html">比較</a></li>
                <li><a href="/xarpite/docs/ja/boolean.html">論理値・条件分岐</a></li>
                <li><a href="/xarpite/docs/ja/jump.html">リターン・エラー処理</a></li>
                <li><a href="/xarpite/docs/ja/property.html">プロパティアクセス</a></li>
                <li><a href="/xarpite/docs/ja/array.html">配列</a></li>
                <li><a href="/xarpite/docs/ja/object.html">オブジェクト</a></li>
                <li><a href="/xarpite/docs/ja/function.html">関数</a></li>
                <li><a href="/xarpite/docs/ja/stream.html">ストリーム・代入・パイプ系演算子</a></li>
                <li><a href="/xarpite/docs/ja/builtin.html">組み込み定数・関数</a></li>
                <li><a href="/xarpite/docs/ja/data_conversion.html">データ変換系関数</a></li>
                <li><a href="/xarpite/docs/ja/samples.html">サンプル</a></li>
                <li><a href="/xarpite/docs/ja/cli.html">コマンドラインツール</a></li>
                <li><a href="/xarpite/docs/ja/js.html">JavaScript版</a></li>
                <li><a href="/xarpite/docs/ja/coroutine.html">コルーチン</a></li>
                <li><a href="/xarpite/docs/ja/json.html">JSON操作</a></li>
              </ul>
            </nav>
          </aside>

          <article class="doc-content">
            <p>組み込み定数は、コード上で定義することなく利用可能な、言語機能に付属する定数です。</p>

<p>組み込み定数は大文字および <code class="language-plaintext highlighter-rouge">_</code> のみを使って定義されます。</p>

<p>組み込みの関数も組み込み定数と同じメカニズムによって提供されます。</p>

<h1 id="組み込みオブジェクトのクラス定数">組み込みオブジェクトのクラス定数</h1>

<p>各種組み込みオブジェクトのクラスを参照できます。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">VALUE</code></li>
  <li><code class="language-plaintext highlighter-rouge">NULL_CLASS</code></li>
  <li><code class="language-plaintext highlighter-rouge">INT</code></li>
  <li><code class="language-plaintext highlighter-rouge">DOUBLE</code></li>
  <li><code class="language-plaintext highlighter-rouge">BOOLEAN</code></li>
  <li><code class="language-plaintext highlighter-rouge">STRING</code></li>
  <li><code class="language-plaintext highlighter-rouge">REGEX</code></li>
  <li><code class="language-plaintext highlighter-rouge">ARRAY</code></li>
  <li><code class="language-plaintext highlighter-rouge">OBJECT</code></li>
  <li><code class="language-plaintext highlighter-rouge">FUNCTION</code></li>
  <li><code class="language-plaintext highlighter-rouge">STREAM</code></li>
  <li><code class="language-plaintext highlighter-rouge">PROMISE</code></li>
  <li><code class="language-plaintext highlighter-rouge">BLOB</code></li>
</ul>

<h1 id="定数">定数</h1>

<p>各種、特別な値を表す定数です。</p>

<table>
  <thead>
    <tr>
      <th>定数</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">NULL</code> <code class="language-plaintext highlighter-rouge">N</code></td>
      <td>NULL値</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">TRUE</code> <code class="language-plaintext highlighter-rouge">T</code></td>
      <td>真</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">FALSE</code> <code class="language-plaintext highlighter-rouge">F</code></td>
      <td>偽</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">EMPTY</code> <code class="language-plaintext highlighter-rouge">E</code></td>
      <td>空のストリーム</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">LOOP</code></td>
      <td>無限にNULLを生成するストリーム</td>
    </tr>
  </tbody>
</table>

<hr />

<p>数学系の組み込み定数です。</p>

<table>
  <thead>
    <tr>
      <th>定数</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">MATH.PI</code></td>
      <td>円周率</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">MATH.E</code></td>
      <td>ネイピア数</td>
    </tr>
  </tbody>
</table>

<hr />

<p>文字列系の組み込み定数です。</p>

<table>
  <thead>
    <tr>
      <th>定数</th>
      <th>意味</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">LT</code></td>
      <td><code class="language-plaintext highlighter-rouge">&lt;</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">GT</code></td>
      <td><code class="language-plaintext highlighter-rouge">&gt;</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">AMP</code></td>
      <td><code class="language-plaintext highlighter-rouge">&amp;</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">APOS</code></td>
      <td><code class="language-plaintext highlighter-rouge">'</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">QUOT</code></td>
      <td><code class="language-plaintext highlighter-rouge">"</code></td>
    </tr>
  </tbody>
</table>

<h1 id="数学系関数">数学系関数</h1>

<h2 id="abs-絶対値の取得"><code class="language-plaintext highlighter-rouge">ABS</code> 絶対値の取得</h2>

<p><code class="language-plaintext highlighter-rouge">ABS(value: NUMBER): NUMBER</code></p>

<p>第1引数の絶対値を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'ABS(-10)'</span>
<span class="c"># 10</span>
</code></pre></div></div>

<h2 id="floor-小数点以下切り捨て"><code class="language-plaintext highlighter-rouge">FLOOR</code> 小数点以下切り捨て</h2>

<p><code class="language-plaintext highlighter-rouge">FLOOR(number: NUMBER): INTEGER</code></p>

<p>第1引数の数値を、値が小さい方の整数に丸めます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'FLOOR(1.5)'</span>
<span class="c"># 1</span>
</code></pre></div></div>

<h2 id="div-除算の整数部"><code class="language-plaintext highlighter-rouge">DIV</code> 除算の整数部</h2>

<p><code class="language-plaintext highlighter-rouge">DIV(x: NUMBER; y: NUMBER): NUMBER</code></p>

<p><code class="language-plaintext highlighter-rouge">x</code> を <code class="language-plaintext highlighter-rouge">y</code> で割り、その結果の整数部分を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'DIV(10; 3)'</span>
<span class="c"># 3</span>
</code></pre></div></div>

<h2 id="sqrt-平方根の取得"><code class="language-plaintext highlighter-rouge">SQRT</code> 平方根の取得</h2>

<p><code class="language-plaintext highlighter-rouge">SQRT(number: NUMBER): NUMBER</code></p>

<p>第1引数の正の平方根を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  SQRT(100.0)  )"'</span>
<span class="c"># 10.000</span>
</code></pre></div></div>

<h2 id="sin-正弦"><code class="language-plaintext highlighter-rouge">SIN</code> 正弦</h2>

<p><code class="language-plaintext highlighter-rouge">SIN(number: NUMBER): NUMBER</code></p>

<p>第1引数をラジアンとして解釈し、その正弦を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  SIN(PI / 2)  )"'</span>
<span class="c"># 1.000</span>
</code></pre></div></div>

<h2 id="cos-余弦"><code class="language-plaintext highlighter-rouge">COS</code> 余弦</h2>

<p><code class="language-plaintext highlighter-rouge">COS(number: NUMBER): NUMBER</code></p>

<p>第1引数をラジアンとして解釈し、その余弦を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  COS(0)  )"'</span>
<span class="c"># 1.000</span>
</code></pre></div></div>

<h2 id="tan-正接"><code class="language-plaintext highlighter-rouge">TAN</code> 正接</h2>

<p><code class="language-plaintext highlighter-rouge">TAN(number: NUMBER): NUMBER</code></p>

<p>第1引数をラジアンとして解釈し、その正接を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  TAN(PI / 4)  )"'</span>
<span class="c"># 1.000</span>
</code></pre></div></div>

<h2 id="pow-べき乗"><code class="language-plaintext highlighter-rouge">POW</code> べき乗</h2>

<p><code class="language-plaintext highlighter-rouge">POW(base: NUMBER; exponent: NUMBER): NUMBER</code></p>

<p>第1引数を第2引数でべき乗した結果を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'POW(2; 3)'</span>
<span class="c"># 8.0</span>
</code></pre></div></div>

<h2 id="exp-指数関数"><code class="language-plaintext highlighter-rouge">EXP</code> 指数関数</h2>

<p><code class="language-plaintext highlighter-rouge">EXP(number: NUMBER): NUMBER</code></p>

<p>第1引数の指数関数（底 e）を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  EXP(1)  )"'</span>
<span class="c"># 2.718</span>

<span class="nv">$ </span>xa <span class="s1">'"$%.3f(  EXP(2)  )"'</span>
<span class="c"># 7.389</span>
</code></pre></div></div>

<h2 id="log-自然対数"><code class="language-plaintext highlighter-rouge">LOG</code> 自然対数</h2>

<p><code class="language-plaintext highlighter-rouge">LOG(number: NUMBER): NUMBER</code></p>

<p>第1引数の自然対数（底 e）を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"$%.3f(  LOG(MATH.E)  )"'</span>
<span class="c"># 1.000</span>
</code></pre></div></div>

<h2 id="rand-乱数の取得"><code class="language-plaintext highlighter-rouge">RAND</code> 乱数の取得</h2>

<p><code class="language-plaintext highlighter-rouge">RAND(): DOUBLE</code></p>

<p><code class="language-plaintext highlighter-rouge">RAND([from: NUMBER; ]until: NUMBER): INT</code></p>

<p>引数なしで呼び出された場合、0以上1未満の小数を返します。</p>

<p>1引数で呼び出された場合、0以上 <code class="language-plaintext highlighter-rouge">until</code> 未満の整数を返します。</p>

<p>2引数で呼び出された場合、<code class="language-plaintext highlighter-rouge">from</code> 以上 <code class="language-plaintext highlighter-rouge">until</code> 未満の整数を返します。</p>

<h1 id="ストリーム系関数">ストリーム系関数</h1>

<h2 id="reverse-ストリームを逆順にする"><code class="language-plaintext highlighter-rouge">REVERSE</code> ストリームを逆順にする</h2>

<p><code class="language-plaintext highlighter-rouge">REVERSE(stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第1引数のストリームの要素を逆順にしたストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'REVERSE(1 .. 3)'</span>
<span class="c"># 3</span>
<span class="c"># 2</span>
<span class="c"># 1</span>
</code></pre></div></div>

<h2 id="shuffle-ストリームをランダムな順序にする"><code class="language-plaintext highlighter-rouge">SHUFFLE</code> ストリームをランダムな順序にする</h2>

<p><code class="language-plaintext highlighter-rouge">&lt;T&gt; SHUFFLE(stream: T,): T,</code></p>

<p><code class="language-plaintext highlighter-rouge">stream</code> の要素をランダムに並べ替えたストリームを返します。</p>

<h2 id="distinct-ストリームの重複要素を除去"><code class="language-plaintext highlighter-rouge">DISTINCT</code> ストリームの重複要素を除去</h2>

<p>ストリームから重複する要素を取り除いたストリームを返します。</p>

<p><code class="language-plaintext highlighter-rouge">DISTINCT</code> は、2種類の呼び出し方があります。</p>

<h3 id="要素そのもので重複判定">要素そのもので重複判定</h3>

<p><code class="language-plaintext highlighter-rouge">DISTINCT(stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>1引数で呼び出した場合、そのストリームの要素そのものを使って重複を判定し、重複を除去したストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3, 3, 3, 2, 1, 0 &gt;&gt; DISTINCT'</span>
<span class="c"># 1</span>
<span class="c"># 2</span>
<span class="c"># 3</span>
<span class="c"># 0</span>
</code></pre></div></div>

<h3 id="キー取得関数による重複判定">キー取得関数による重複判定</h3>

<p><code class="language-plaintext highlighter-rouge">DISTINCT(by: keyGetter: VALUE -&gt; VALUE; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第1引数が <code class="language-plaintext highlighter-rouge">by</code> パラメータである場合、第2引数の各要素に対して <code class="language-plaintext highlighter-rouge">keyGetter</code> 関数を適用し、その結果で重複を判定します。</p>

<p>以下の例では、各要素を10で割った余りで重複を判定しています。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'13, 21, 24, 33, 31, 34 &gt;&gt; DISTINCT[by: x -&gt; x % 10]'</span>
<span class="c"># 13</span>
<span class="c"># 21</span>
<span class="c"># 24</span>
</code></pre></div></div>

<h2 id="join-ストリームを文字列に連結"><code class="language-plaintext highlighter-rouge">JOIN</code> ストリームを文字列に連結</h2>

<p><code class="language-plaintext highlighter-rouge">JOIN([separator: STRING; ]stream: STREAM&lt;STRING&gt;): STRING</code></p>

<p>第2引数のストリームの各要素を第1引数のセパレータで連結した文字列を返します。第1引数を省略した場合は <code class="language-plaintext highlighter-rouge">,</code> が使用されます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'JOIN("|"; "a", "b", "c")'</span>
<span class="c"># a|b|c</span>

<span class="nv">$ </span>xa <span class="s1">'JOIN("a", "b", "c")'</span>
<span class="c"># a,b,c</span>
</code></pre></div></div>

<hr />

<p>セパレータやストリームの各要素は文字列化されます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'JOIN(0; 1, "b", {`&amp;_`: _ -&gt; "c"}{})'</span>
<span class="c"># 10b0c</span>
</code></pre></div></div>

<hr />

<p>部分適用とともに用いることで、パイプチェーンに組み込みやすくなります。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1 .. 3 | _ * 10 &gt;&gt; JOIN["|"]'</span>
<span class="c"># 10|20|30</span>
</code></pre></div></div>

<h2 id="split-文字列をストリームに分割"><code class="language-plaintext highlighter-rouge">SPLIT</code> 文字列をストリームに分割</h2>

<p><code class="language-plaintext highlighter-rouge">SPLIT([separator: STRING; ]string: STRING): STREAM&lt;STRING&gt;</code></p>

<p>第2引数の文字列を第1引数のセパレータで分割し、各部分をストリームとして返します。第1引数を省略した場合は <code class="language-plaintext highlighter-rouge">,</code> が使用されます。</p>

<p>パイプ演算子との親和性のために配列ではなくストリームとして返されることに注意してください。</p>

<p><code class="language-plaintext highlighter-rouge">SPLIT</code> は概念的に <code class="language-plaintext highlighter-rouge">JOIN</code> と逆の操作を行います。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'SPLIT("|"; "a|b|c")'</span>
<span class="c"># a</span>
<span class="c"># b</span>
<span class="c"># c</span>

<span class="nv">$ </span>xa <span class="s1">'SPLIT("a,b,c")'</span>
<span class="c"># a</span>
<span class="c"># b</span>
<span class="c"># c</span>
</code></pre></div></div>

<hr />

<p>セパレータや分割対象文字列は文字列化されて評価されます。</p>

<hr />

<p>部分適用とともに用いることで、パイプチェーンに組み込みやすくなります。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'"10|20|30" &gt;&gt; SPLIT["|"] | +_ / 10'</span>
<span class="c"># 1.0</span>
<span class="c"># 2.0</span>
<span class="c"># 3.0</span>
</code></pre></div></div>

<h2 id="keys-オブジェクトのキーのストリームを取得"><code class="language-plaintext highlighter-rouge">KEYS</code> オブジェクトのキーのストリームを取得</h2>

<p><code class="language-plaintext highlighter-rouge">KEYS(object: OBJECT): STREAM&lt;STRING&gt;</code></p>

<p>第1引数のオブジェクトのキーのストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'KEYS({a: 1; b: 2; c: 3})'</span>
<span class="c"># a</span>
<span class="c"># b</span>
<span class="c"># c</span>
</code></pre></div></div>

<h2 id="values-オブジェクトの値のストリームを取得"><code class="language-plaintext highlighter-rouge">VALUES</code> オブジェクトの値のストリームを取得</h2>

<p><code class="language-plaintext highlighter-rouge">VALUES(object: OBJECT): STREAM&lt;VALUE&gt;</code></p>

<p>第1引数のオブジェクトの値のストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'VALUES({a: 1; b: 2; c: 3})'</span>
<span class="c"># 1</span>
<span class="c"># 2</span>
<span class="c"># 3</span>
</code></pre></div></div>

<h2 id="sum-ストリームの要素の合計"><code class="language-plaintext highlighter-rouge">SUM</code> ストリームの要素の合計</h2>

<p><code class="language-plaintext highlighter-rouge">SUM(numbers: STREAM&lt;NUMBER&gt;): NUMBER</code></p>

<p>第1引数のストリームの各要素を加算した値を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'SUM(1 .. 3)'</span>
<span class="c"># 6</span>
</code></pre></div></div>

<h2 id="min-ストリームの最小値"><code class="language-plaintext highlighter-rouge">MIN</code> ストリームの最小値</h2>

<p><code class="language-plaintext highlighter-rouge">MIN(numbers: STREAM&lt;NUMBER&gt;): NUMBER</code></p>

<p>第1引数のストリームの最小値を返します。</p>

<p>ストリームが空の場合は <code class="language-plaintext highlighter-rouge">NULL</code> を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'MIN(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)'</span>
<span class="c"># 1</span>

<span class="nv">$ </span>xa <span class="s1">'MIN(,)'</span>
<span class="c"># NULL</span>
</code></pre></div></div>

<h2 id="max-ストリームの最大値"><code class="language-plaintext highlighter-rouge">MAX</code> ストリームの最大値</h2>

<p><code class="language-plaintext highlighter-rouge">MAX(numbers: STREAM&lt;NUMBER&gt;): NUMBER</code></p>

<p>第1引数のストリームの最大値を返します。</p>

<p>ストリームが空の場合は <code class="language-plaintext highlighter-rouge">NULL</code> を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'MAX(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)'</span>
<span class="c"># 9</span>

<span class="nv">$ </span>xa <span class="s1">'MAX(,)'</span>
<span class="c"># NULL</span>
</code></pre></div></div>

<h2 id="count-ストリームの要素数"><code class="language-plaintext highlighter-rouge">COUNT</code> ストリームの要素数</h2>

<p><code class="language-plaintext highlighter-rouge">COUNT(stream: STREAM&lt;VALUE&gt;): INT</code></p>

<p>第1引数のストリームの要素数を返します。</p>

<p>非ストリームの場合、1を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'COUNT(1, 2, 3)'</span>
<span class="c"># 3</span>

<span class="nv">$ </span>xa <span class="s1">'COUNT(1)'</span>
<span class="c"># 1</span>

<span class="nv">$ </span>xa <span class="s1">'COUNT(,)'</span>
<span class="c"># 0</span>
</code></pre></div></div>

<h2 id="first-ストリームの先頭要素を取得"><code class="language-plaintext highlighter-rouge">FIRST</code> ストリームの先頭要素を取得</h2>

<p><code class="language-plaintext highlighter-rouge">FIRST(stream: STREAM&lt;VALUE&gt;): VALUE</code></p>

<p>第1引数のストリームの先頭要素を返します。ストリームが空の場合は <code class="language-plaintext highlighter-rouge">NULL</code> を返します。</p>

<p>非ストリームを渡した場合は、その値をそのまま返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'FIRST(4, 5, 6)'</span>
<span class="c"># 4</span>

<span class="nv">$ </span>xa <span class="s1">'FIRST(4)'</span>
<span class="c"># 4</span>

<span class="nv">$ </span>xa <span class="s1">'FIRST(,)'</span>
<span class="c"># NULL</span>
</code></pre></div></div>

<h2 id="last-ストリームの末尾要素を取得"><code class="language-plaintext highlighter-rouge">LAST</code> ストリームの末尾要素を取得</h2>

<p><code class="language-plaintext highlighter-rouge">LAST(stream: STREAM&lt;VALUE&gt;): VALUE</code></p>

<p>第1引数のストリームの末尾要素を返します。ストリームが空の場合は <code class="language-plaintext highlighter-rouge">NULL</code> を返します。</p>

<p>非ストリームを渡した場合は、その値をそのまま返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'LAST(4, 5, 6)'</span>
<span class="c"># 6</span>

<span class="nv">$ </span>xa <span class="s1">'LAST(6)'</span>
<span class="c"># 6</span>

<span class="nv">$ </span>xa <span class="s1">'LAST(,)'</span>
<span class="c"># NULL</span>
</code></pre></div></div>

<h2 id="single-ストリームの唯一の要素を取得"><code class="language-plaintext highlighter-rouge">SINGLE</code> ストリームの唯一の要素を取得</h2>

<p><code class="language-plaintext highlighter-rouge">&lt;T&gt; SINGLE(stream: STREAM&lt;T&gt;): T</code></p>

<p>第1引数のストリームの唯一の要素を返します。ストリームが空か複数要素を持つ場合は例外をスローします。</p>

<p>非ストリームを渡した場合は、その値をそのまま返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'SINGLE(4, 5, 6) !? "Error"'</span>
<span class="c"># Error</span>

<span class="nv">$ </span>xa <span class="s1">'SINGLE(6)'</span>
<span class="c"># 6</span>

<span class="nv">$ </span>xa <span class="s1">'SINGLE(,) !? "Error"'</span>
<span class="c"># Error</span>
</code></pre></div></div>

<h2 id="sort-ストリームを昇順にソートする"><code class="language-plaintext highlighter-rouge">SORT</code> ストリームを昇順にソートする</h2>

<p>ストリームを昇順にソートします。</p>

<p><code class="language-plaintext highlighter-rouge">SORT</code> は、3種類の呼び出し方があります。</p>

<h3 id="自然順序付けによるソート">自然順序付けによるソート</h3>

<p><code class="language-plaintext highlighter-rouge">SORT(stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>1引数で呼び出した場合、そのストリームの要素を昇順にソートしたストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5 &gt;&gt; SORT &gt;&gt; JOIN[" "]'</span>
<span class="c"># 1 1 2 3 3 4 5 5 5 6 9</span>
</code></pre></div></div>

<h3 id="比較関数によるソート">比較関数によるソート</h3>

<p><code class="language-plaintext highlighter-rouge">SORT(comparator: VALUE, VALUE -&gt; INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>2引数で呼び出した場合、第1引数の比較関数を使用して第2引数のストリームをソートします。</p>

<p>以下の例では、各要素を3で割った余りでソートしています。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1 .. 9 &gt;&gt; SORT[a, b -&gt; a % 3 &lt;=&gt; b % 3] &gt;&gt; JOIN[" "]'</span>
<span class="c"># 3 6 9 1 4 7 2 5 8</span>
</code></pre></div></div>

<h3 id="キー取得関数によるソート">キー取得関数によるソート</h3>

<p><code class="language-plaintext highlighter-rouge">SORT(by: key_getter: VALUE -&gt; VALUE; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第1引数が <code class="language-plaintext highlighter-rouge">by</code> パラメータである場合、第2引数の各要素に対して <code class="language-plaintext highlighter-rouge">key_getter</code> 関数を適用し、その結果を比較してソートします。</p>

<p>以下の例では、各要素を3で割った余りでソートしています。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1 .. 9 &gt;&gt; SORT[by: x -&gt; x % 3] &gt;&gt; JOIN[" "]'</span>
<span class="c"># 3 6 9 1 4 7 2 5 8</span>
</code></pre></div></div>

<h2 id="sortr-ストリームを降順にソートする"><code class="language-plaintext highlighter-rouge">SORTR</code> ストリームを降順にソートする</h2>

<p><code class="language-plaintext highlighter-rouge">SORTR(stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p><code class="language-plaintext highlighter-rouge">SORTR(comparator: VALUE, VALUE -&gt; INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p><code class="language-plaintext highlighter-rouge">SORTR(by: key_getter: VALUE -&gt; VALUE; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>ストリームを降順にソートします。</p>

<p>ソートが降順である点を除き、 <code class="language-plaintext highlighter-rouge">SORT</code> 関数と同じです。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5 &gt;&gt; SORTR &gt;&gt; JOIN[" "]'</span>
<span class="c"># 9 6 5 5 5 4 3 3 2 1 1</span>
</code></pre></div></div>

<h2 id="group-ストリームをキーでグループ化"><code class="language-plaintext highlighter-rouge">GROUP</code> ストリームをキーでグループ化</h2>

<p><code class="language-plaintext highlighter-rouge">&lt;T, K&gt; GROUP(by = key_getter: T -&gt; K; stream: T,): [K; [T,]],</code></p>

<p><code class="language-plaintext highlighter-rouge">stream</code> の各要素に対して <code class="language-plaintext highlighter-rouge">key_getter</code> を適用し、同一のキーとなる値をエントリー配列にまとめてストリームで返します。</p>

<p>エントリー配列は、最初にそのキーが現れた順序になります。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'
  {category: "fruit" ; value: "apple" },
  {category: "fruit" ; value: "banana"},
  {category: "animal"; value: "cat"   },
  &gt;&gt; GROUP[by: x -&gt; x.category]
'</span>
<span class="c"># [fruit;[{category:fruit;value:apple};{category:fruit;value:banana}]]</span>
<span class="c"># [animal;[{category:animal;value:cat}]]</span>
</code></pre></div></div>

<hr />

<p>キーが文字列化可能な場合、 <code class="language-plaintext highlighter-rouge">TO_OBJECT</code> 関数によって簡単にオブジェクトにまとめることができます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'
  object := (
    {category: "fruit" ; value: "apple" },
    {category: "fruit" ; value: "banana"},
    {category: "animal"; value: "cat"   },
    &gt;&gt; GROUP[by: x -&gt; x.category]
    &gt;&gt; TO_OBJECT
  )
  object.fruit() | _.value
'</span>
<span class="c"># apple</span>
<span class="c"># banana</span>
</code></pre></div></div>

<h2 id="chunk-ストリームを一定サイズの配列に分割"><code class="language-plaintext highlighter-rouge">CHUNK</code> ストリームを一定サイズの配列に分割</h2>

<p><code class="language-plaintext highlighter-rouge">CHUNK(size: NUMBER; stream: STREAM&lt;VALUE&gt;): STREAM&lt;ARRAY&lt;VALUE&gt;&gt;</code></p>

<p>第2引数のストリームの要素を第1引数で指定したサイズごとにまとめた配列のストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3, 4, 5 &gt;&gt; CHUNK[2]'</span>
<span class="c"># [1;2]</span>
<span class="c"># [3;4]</span>
<span class="c"># [5]</span>
</code></pre></div></div>

<h2 id="take-ストリームの先頭を取得"><code class="language-plaintext highlighter-rouge">TAKE</code> ストリームの先頭を取得</h2>

<p><code class="language-plaintext highlighter-rouge">TAKE(count: INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第2引数のストリームから先頭 <code class="language-plaintext highlighter-rouge">count</code> 個の要素を取り出したストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; TAKE[2]'</span>
<span class="c"># 1</span>
<span class="c"># 2</span>
</code></pre></div></div>

<h2 id="taker-ストリームの末尾を取得"><code class="language-plaintext highlighter-rouge">TAKER</code> ストリームの末尾を取得</h2>

<p><code class="language-plaintext highlighter-rouge">TAKER(count: INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第2引数のストリームから末尾 <code class="language-plaintext highlighter-rouge">count</code> 個の要素を取り出したストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; TAKER[2]'</span>
<span class="c"># 2</span>
<span class="c"># 3</span>
</code></pre></div></div>

<h2 id="drop-ストリームの先頭を破棄"><code class="language-plaintext highlighter-rouge">DROP</code> ストリームの先頭を破棄</h2>

<p><code class="language-plaintext highlighter-rouge">DROP(count: INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第2引数のストリームから先頭 <code class="language-plaintext highlighter-rouge">count</code> 個の要素を取り除いたストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; DROP[2]'</span>
<span class="c"># 3</span>
</code></pre></div></div>

<h2 id="dropr-ストリームの末尾を破棄"><code class="language-plaintext highlighter-rouge">DROPR</code> ストリームの末尾を破棄</h2>

<p><code class="language-plaintext highlighter-rouge">DROPR(count: INT; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第2引数のストリームから末尾 <code class="language-plaintext highlighter-rouge">count</code> 個の要素を取り除いたストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; DROPR[2]'</span>
<span class="c"># 1</span>
</code></pre></div></div>

<h2 id="filter-ストリームを条件で抽出"><code class="language-plaintext highlighter-rouge">FILTER</code> ストリームを条件で抽出</h2>

<p><code class="language-plaintext highlighter-rouge">FILTER(predicate: VALUE -&gt; BOOLEAN; stream: STREAM&lt;VALUE&gt;): STREAM&lt;VALUE&gt;</code></p>

<p>第2引数のストリームの各要素に <code class="language-plaintext highlighter-rouge">predicate</code> を適用し、その結果が真となった要素のみを含むストリームを返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1, 2, 3, 4, 5 &gt;&gt; FILTER [ x =&gt; x % 2 == 0 ]'</span>
<span class="c"># 2</span>
<span class="c"># 4</span>
</code></pre></div></div>

<h2 id="reduce-ストリームの要素を累積する"><code class="language-plaintext highlighter-rouge">REDUCE</code> ストリームの要素を累積する</h2>

<p><code class="language-plaintext highlighter-rouge">REDUCE(function: VALUE, VALUE -&gt; VALUE; stream: STREAM&lt;VALUE&gt;): VALUE</code></p>

<p><code class="language-plaintext highlighter-rouge">REDUCE</code> は <code class="language-plaintext highlighter-rouge">stream</code> の隣り合った要素を <code class="language-plaintext highlighter-rouge">function</code> によって累積し、一つの値に集約する関数です。</p>

<p><code class="language-plaintext highlighter-rouge">REDUCE</code> は、しばしば部分適用によってストリームを処理する関数として用いられます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'REDUCE(a, b -&gt; a + b; 1 .. 4)'</span>
<span class="c"># 10</span>

<span class="nv">$ </span>xa <span class="s1">'1 .. 4 &gt;&gt; REDUCE[a, b -&gt; a + b]'</span>
<span class="c"># 10</span>
</code></pre></div></div>

<p>この例は、1から4までのすべての隣接する値に対して <code class="language-plaintext highlighter-rouge">a + b</code> を適当します。</p>

<p>すなわち、 <code class="language-plaintext highlighter-rouge">1 + 2 + 3 + 4</code> と同じです。</p>

<hr />

<p>ストリームの要素が1つしかない、もしくはストリームでない場合、その要素をそのまま返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'1 &gt;&gt; REDUCE[a, b -&gt; a + b]'</span>
<span class="c"># 1</span>
</code></pre></div></div>

<hr />

<p>ストリームが空の場合、 <code class="language-plaintext highlighter-rouge">NULL</code> を返します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">', &gt;&gt; REDUCE[a, b -&gt; a + b]'</span>
<span class="c"># NULL</span>
</code></pre></div></div>

<h2 id="to_string-文字列化"><code class="language-plaintext highlighter-rouge">TO_STRING</code> 文字列化</h2>

<p><code class="language-plaintext highlighter-rouge">TO_STRING(value: VALUE): STRING</code></p>

<p>値を文字列に変換します。</p>

<p><code class="language-plaintext highlighter-rouge">&amp;value</code> 演算子と同じ動作をします。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'TO_STRING(123)'</span>
<span class="c"># 123</span>

<span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; TO_STRING'</span>
<span class="c"># 123</span>
</code></pre></div></div>

<h2 id="to_number-数値化"><code class="language-plaintext highlighter-rouge">TO_NUMBER</code> 数値化</h2>

<p><code class="language-plaintext highlighter-rouge">TO_NUMBER(value: VALUE): NUMBER</code></p>

<p>値を数値に変換します。</p>

<p><code class="language-plaintext highlighter-rouge">+value</code> 演算子と同じ動作をします。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'TO_NUMBER("123")'</span>
<span class="c"># 123</span>

<span class="nv">$ </span>xa <span class="s1">'1, 2, 3 &gt;&gt; TO_NUMBER'</span>
<span class="c"># 6</span>

<span class="nv">$ </span>xa <span class="s1">'TO_NUMBER(NULL)'</span>
<span class="c"># 0</span>
</code></pre></div></div>

<h2 id="to_boolean-論理値化"><code class="language-plaintext highlighter-rouge">TO_BOOLEAN</code> 論理値化</h2>

<p><code class="language-plaintext highlighter-rouge">TO_BOOLEAN(value: VALUE): BOOLEAN</code></p>

<p>値を論理値に変換します。</p>

<p><code class="language-plaintext highlighter-rouge">?value</code> 演算子と同じ動作をします。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'TO_BOOLEAN("")'</span>
<span class="c"># FALSE</span>

<span class="nv">$ </span>xa <span class="s1">'TO_BOOLEAN("a")'</span>
<span class="c"># TRUE</span>

<span class="nv">$ </span>xa <span class="s1">'FALSE, TRUE, FALSE &gt;&gt; TO_BOOLEAN'</span>
<span class="c"># TRUE</span>
</code></pre></div></div>

<h2 id="to_array-ストリームを配列に変換"><code class="language-plaintext highlighter-rouge">TO_ARRAY</code> ストリームを配列に変換</h2>

<p><code class="language-plaintext highlighter-rouge">ARRAY(stream: STREAM&lt;VALUE&gt;): ARRAY&lt;VALUE&gt;</code></p>

<p>第1引数のストリームの各要素を配列に変換します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'TO_ARRAY(1 .. 3)'</span>
<span class="c"># [1;2;3]</span>
</code></pre></div></div>

<h2 id="to_object-エントリーのストリームをオブジェクトに変換"><code class="language-plaintext highlighter-rouge">TO_OBJECT</code> エントリーのストリームをオブジェクトに変換</h2>

<p><code class="language-plaintext highlighter-rouge">OBJECT(stream: STREAM&lt;ARRAY&lt;STRING; VALUE&gt;&gt;): OBJECT</code></p>

<p>第1引数のストリームの各要素をエントリーとしてオブジェクトに変換します。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>xa <span class="s1">'TO_OBJECT(("a": 1), ("b": 2), ("c": 3))'</span>
<span class="c"># {a:1;b:2;c:3}</span>
</code></pre></div></div>

          </article>
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="footer-content">
          <p class="footer-text">
            &copy; 2024-2025 <a href="https://github.com/MirrgieRiana" target="_blank" class="footer-link">MirrgieRiana</a>.
            <a href="https://github.com/MirrgieRiana/xarpite" target="_blank" class="footer-link">GitHub</a>
          </p>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // Highlight current page in navigation
    document.addEventListener('DOMContentLoaded', function() {
      const currentPath = window.location.pathname.replace(/\/$/, ''); // Remove trailing slash
      const navLinks = document.querySelectorAll('.doc-nav a');

      navLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href) {
          const normalizedHref = href.replace(/\/$/, '');
          if (currentPath === normalizedHref || currentPath === normalizedHref + '.html' || currentPath.replace('.html', '') === normalizedHref) {
            link.classList.add('active');
          }
        }
      });

      // Add copy buttons to code blocks
      const codeBlocks = document.querySelectorAll('.doc-content pre');
      codeBlocks.forEach(function(preElement) {
        // Skip if already wrapped
        if (preElement.parentElement.classList.contains('code-block-wrapper')) {
          return;
        }

        // Create wrapper
        const wrapper = document.createElement('div');
        wrapper.className = 'code-block-wrapper';

        // Create copy button
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-code-button';
        copyButton.textContent = 'Copy';
        copyButton.setAttribute('aria-label', 'Copy code');

        // Add click handler
        copyButton.addEventListener('click', function() {
          const code = preElement.querySelector('code') || preElement;
          const textToCopy = code.textContent;

          // Try modern clipboard API first (requires secure context: HTTPS or localhost)
          const isSecure = window.isSecureContext ||
                          window.location.protocol === 'https:' ||
                          window.location.hostname === 'localhost';

          if (navigator.clipboard && isSecure) {
            navigator.clipboard.writeText(textToCopy).then(function() {
              copyButton.textContent = 'Copied!';
              copyButton.classList.add('copied');

              setTimeout(function() {
                copyButton.textContent = 'Copy';
                copyButton.classList.remove('copied');
              }, 2000);
            }).catch(function(err) {
              console.error('Failed to copy:', err);
              copyButton.textContent = 'Failed';
              setTimeout(function() {
                copyButton.textContent = 'Copy';
              }, 2000);
            });
          } else {
            // Fallback using deprecated execCommand for legacy browser support
            const textarea = document.createElement('textarea');
            textarea.value = textToCopy;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();

            try {
              const successful = document.execCommand('copy');
              if (successful) {
                copyButton.textContent = 'Copied!';
                copyButton.classList.add('copied');

                setTimeout(function() {
                  copyButton.textContent = 'Copy';
                  copyButton.classList.remove('copied');
                }, 2000);
              } else {
                copyButton.textContent = 'Failed';
                setTimeout(function() {
                  copyButton.textContent = 'Copy';
                }, 2000);
              }
            } catch (err) {
              console.error('Failed to copy:', err);
              copyButton.textContent = 'Failed';
              setTimeout(function() {
                copyButton.textContent = 'Copy';
              }, 2000);
            } finally {
              document.body.removeChild(textarea);
            }
          }
        });

        // Wrap the pre element
        preElement.parentNode.insertBefore(wrapper, preElement);
        wrapper.appendChild(preElement);
        wrapper.appendChild(copyButton);
      });
    });
  </script>
</body>
</html>
